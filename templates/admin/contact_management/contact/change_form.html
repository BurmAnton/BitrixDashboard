{% extends "admin/change_form.html" %}

{% block admin_change_form_document_ready %}
    {{ block.super }}
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const typeField = document.getElementById("id_type");
            const personFields = [
                document.getElementById("id_first_name"),
                document.getElementById("id_last_name"),
                document.getElementById("id_middle_name"),
                document.getElementById("id_first_name_dat"),
                document.getElementById("id_last_name_dat"),
                document.getElementById("id_middle_name_dat"),
                document.getElementById("id_position"),
                document.getElementById("id_position_dat")
            ];
            const departmentField = document.getElementById("id_department_name");

            function toggleFields() {
                const typeValue = typeField.value;

                personFields.forEach(el => {
                    if (!el) return;
                    el.closest(".form-row").style.display = typeValue === "person" ? "" : "none";
                });

                if (departmentField) {
                    departmentField.closest(".form-row").style.display = typeValue === "department" ? "" : "none";
                }
            }

            if (typeField) {
                typeField.addEventListener("change", toggleFields);
                toggleFields();
            }
        });
    </script>
{% endblock %}
