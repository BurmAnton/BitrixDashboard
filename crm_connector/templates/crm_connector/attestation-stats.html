{% extends "base.html" %}
{% load dict_filters %}
{% block content %}
{% block extra_css %}
<style>
    .container{
        width: 95%; 
        max-width: 95%;
    }
    .messages{
        display: none;
    }
    .potok-card{
        background-color: rgb(245, 245, 245);
        padding: 20px;
        border-radius: 12px;
        margin-top: 12px;
        font-size: large;
        font-weight: 500;
        flex: 1 1 200px;       /* –≥–∏–±–∫–∏–π —Ä–∞–∑–º–µ—Ä: —Ä–∞—Å—Ç—ë—Ç, —Å–∂–∏–º–∞–µ—Ç—Å—è, –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä 200px */
        box-sizing: border-box; /* —É—á–∏—Ç—ã–≤–∞–µ–º padding –∏ border –≤ —Ä–∞–∑–º–µ—Ä–µ */
        min-width: 150px;
    }
    .progress{
        box-shadow: 2px 2px 2px rgb(197, 197, 197);
    }
    .info{
        display: flex;
        align-items: center;
        justify-content: space-between;
    }
    .program{
        background-color: lightgray;
        border-radius: 12px;
        padding: 20px;
        display: flex;
        flex-wrap: wrap;
        justify-content: center; 
        gap: 10px; 
    }
</style>
{% endblock %}
<div class="col-md-6">
        <div class="card h-100">
            <div class="card-body d-flex flex-column">
                <h4 class="card-title">–ò–º–ø–æ—Ä—Ç –∑–∞—è–≤–æ–∫ –∏–∑ Excel</h4>
                <form method="post" enctype="multipart/form-data" class="flex-grow-1 d-flex flex-column">
                    {% csrf_token %}
                    <div class="mb-3 flex-grow-1">
                        <label for="id_excel_file" class="form-label">–í—ã–±–µ—Ä–∏—Ç–µ Excel —Ñ–∞–π–ª —Å –∑–∞—è–≤–∫–∞–º–∏:</label>
                        <input type="file" class="form-control" id="id_excel_file" name="excel_file" accept=".xlsx,.xls">
                    </div>
                    {% for message in messages %}
                        {% if message.extra_tags == 'succ' %}
                            <div class="alert alert-success">{{ message }}</div>
                        {% elif message.extra_tags == 'false' %}
                            <div class="alert alert-danger">{{ message }}</div>
                        {% endif %}
                    {% endfor %}
                    <div class="d-flex justify-content-end mt-auto">
                        <input type="submit" class="btn btn-primary" value="–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å">
                    </div>
                </form>
            </div>
        </div>
</div>
{% for program, potoks in statistic.items %}
    <h2>
        {{ program }}
    </h2>
    <div class="program">
        {% for potok, data in potoks.items %}
            {% if potok != "topics" %}
                <div class="potok-card">
                    <div class="info">
                        <h3>–ü–æ—Ç–æ–∫: {{ potok }}</h3>
                        <p style="text-align: right;">{{ data.listeners }}üßë‚Äçüéì</p>
                    </div>
                    
                    <div>
                        <label>–¢–µ–æ—Ä–∏—è:</label>
                        <div class="progress" style="height: 28px;">
                            <div class="progress-bar" role="progressbar" style="width: {{ data.theory.percent }}%;">{{ data.theory.percent }}%</div>
                        </div>
                        {{ data.theory.done }} / {{ data.theory.total }}
                    </div>

                    <div>
                        <label>–¢–µ—Å—Ç:</label>
                        <div class="progress"style="height: 28px;">
                            <div class="progress-bar bg-success" role="progressbar" style="width: {{ data.test.percent }}%">{{ data.test.percent }}%</div>
                        </div>
                        {{ data.test.done }} / {{ data.test.total }}
                    </div>

                    <div>
                        <label>–ü—Ä–∞–∫—Ç–∏–∫–∞:</label>
                        <div class="progress"style="height: 28px;">
                            <div class="progress-bar bg-warning" role="progressbar" style="width: {{ data.practice.percent }}%">{{ data.practice.percent }}%</div>
                        </div>
                        {{ data.practice.done }} / {{ data.practice.total }}
                    </div>
                </div>
            {% endif %}
        {% endfor %}
        <table class="table table-striped">
            <thead class="table-dark">
                <tr>
                    <th scope="col">–£—Ä–æ–∫</th>
                    <th scope="col">–¢–µ–æ—Ä–∏—è</th>
                    <th scope="col">–ü—Ä–∞–∫—Ç–∏–∫–∞</th>
                    <th scope="col">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</th>
                    <th scope="col">–í—Å–µ–≥–æ</th>
                </tr>   
            </thead>
            <tbody>
                {% with topics=potoks.topics %}
                    {% for topic, material in topics.items %}
                        <tr>
                            <td>{{topic}}</td>
                            
                            <td >
                                {% if material.theory.total != 0 %}
                                <div class="progress" style="height: 20px;">
                                    <div class="progress-bar" role="progressbar" style="width: {{ material.theory.percent }}%">{{ material.theory.percent }}%</div>
                                </div>
                                {{material.theory.done}}/{{material.theory.total}}
                                {% endif %}
                            </td>
                            <td >
                                {% if material.practice.total != 0 %}
                                <div class="progress" style="height: 20px;">
                                    <div class="progress-bar bg-warning" role="progressbar" style="width: {{ material.practice.percent }}%">{{ material.practice.percent }}%</div>
                                </div>
                                {{material.practice.done}}/{{material.practice.total}}
                                {% endif %}
                            </td>
                            <td>
                                {% if material.test.total != 0 %}
                                <div class="progress" style="height: 20px;">
                                    <div class="progress-bar bg-success" role="progressbar" style="width: {{ material.test.percent }}%">{{ material.test.percent }}%</div>
                                </div>
                                {{material.test.done}}/{{material.test.total}}
                                {% endif %}
                            </td>
                            <td>
                                <div class="progress" style="height: 20px;">
                                    <div class="progress-bar bg-success" role="progressbar" style="width: {{ material.total.percent }}%">{{ material.total.percent }}%</div>
                                </div>
                                {{material.total.done}}/{{material.total.total}}
                            </td>
                        </tr>
                    {% endfor %}
                {% endwith %}
            </tbody>
        </table>
    </div>
{% endfor %}
{% endblock %}